# /supervisord.conf

[supervisord]
nodaemon=true
user=app

[program:hub]
command=/app/.venv/bin/gunicorn src.app:app -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:7300
directory=/app
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:gateway]
; Run the gateway as a CLI, not through a module import
command=/bin/bash -lc '
  cd /app/mcpgateway \
  && . .venv/bin/activate \
  && set -a; [ -f .env ] && . ./.env; set +a \
  && python -m mcpgateway.db \
  && exec mcpgateway --host "${HOST:-0.0.0.0}" --port "${PORT:-4444}"'
directory=/app/mcpgateway
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0


