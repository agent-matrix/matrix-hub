{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://matrix-hub/schemas/mcp-server.manifest.schema.json",
  "title": "Matrix Hub â€” MCP Server Manifest",
  "description": "Schema for an MCP Server published to Matrix Hub. Includes core identity, artifacts, and MCP registration for the server. Tight but permissive: unknown fields are allowed.",
  "type": "object",
  "additionalProperties": true,
  "required": [
    "schema_version",
    "type",
    "id",
    "name",
    "version",
    "description",
    "artifacts",
    "license",
    "mcp_registration"
  ],
  "properties": {
    "schema_version": {
      "type": "integer",
      "minimum": 1,
      "description": "Schema version number for this manifest format."
    },
    "type": {
      "const": "mcp_server",
      "description": "Constant literal identifying this manifest as an MCP Server."
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9._-]*$",
      "description": "Stable identifier (scoped within type). Keep to lowercase letters, digits, dot, underscore, or dash."
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Human-friendly name for the server."
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+(\\.[0-9]+)*([-.][0-9A-Za-z.]+)?$",
      "description": "Version string (SemVer-like preferred, but not strictly enforced)."
    },
    "summary": {
      "type": "string",
      "description": "Short, one-paragraph summary of what the server provides."
    },
    "description": {
      "type": "string",
      "minLength": 1,
      "description": "Long-form description of the server, its tools/resources, and behavior."
    },
    "license": {
      "type": "string",
      "description": "Project license identifier or text (SPDX string preferred)."
    },
    "homepage": {
      "type": "string",
      "format": "uri",
      "description": "Homepage URL for the server/project."
    },
    "source_url": {
      "type": "string",
      "format": "uri",
      "description": "Source repository URL (e.g., GitHub)."
    },
    "capabilities": {
      "type": "array",
      "description": "List of capability tags that describe what the server exposes.",
      "items": { "type": "string", "minLength": 1 },
      "uniqueItems": true,
      "default": []
    },
    "tags": {
      "type": "array",
      "description": "Additional free-form tags.",
      "items": { "type": "string", "minLength": 1 },
      "uniqueItems": true,
      "default": []
    },
    "compatibility": {
      "type": "object",
      "description": "Compatibility hints indicating supported frameworks and providers.",
      "additionalProperties": true,
      "properties": {
        "frameworks": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "uniqueItems": true,
          "default": []
        },
        "providers": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "uniqueItems": true,
          "default": []
        },
        "runtime": {
          "type": "string",
          "description": "Optional runtime environment hint (e.g., python3.11)."
        },
        "min_version": {
          "type": "string",
          "description": "Optional minimum supported version of a primary dependency/framework."
        },
        "max_version": {
          "type": "string",
          "description": "Optional maximum supported version of a primary dependency/framework."
        }
      },
      "default": {}
    },
    "artifacts": {
      "type": "array",
      "minItems": 1,
      "description": "Installable artifacts for the server (PyPI package, OCI image, git repo, or zip).",
      "items": { "$ref": "#/$defs/artifact" }
    },
    "endpoints": {
      "type": "object",
      "description": "Optional map of named endpoints the MCP server exposes (e.g., health or readiness URLs).",
      "additionalProperties": true
    },
    "readme": {
      "type": "string",
      "description": "Optional README content inlined into the manifest (Markdown/plaintext)."
    },
    "readme_url": {
      "type": "string",
      "format": "uri",
      "description": "Optional URL to README content."
    },
    "examples": {
      "type": "array",
      "description": "Optional usage examples (free-form text).",
      "items": { "type": "string" },
      "default": []
    },
    "mcp_registration": {
      "type": "object",
      "description": "Instructions for registering this MCP server with an MCP Gateway.",
      "additionalProperties": true,
      "required": ["server"],
      "properties": {
        "server": { "$ref": "#/$defs/mcpServer" },
        "resources": {
          "type": "array",
          "items": { "type": "object", "additionalProperties": true },
          "description": "Optional list of MCP resources to register after server discovery.",
          "default": []
        },
        "prompts": {
          "type": "array",
          "items": { "type": "object", "additionalProperties": true },
          "description": "Optional list of MCP prompts to register.",
          "default": []
        }
      }
    },
    "sig_uri": {
      "type": "string",
      "format": "uri",
      "description": "Optional signature metadata URI (e.g., for cosign/Sigstore)."
    },
    "sbom_uri": {
      "type": "string",
      "format": "uri",
      "description": "Optional SBOM metadata URI."
    }
  },
  "$defs": {
    "artifact": {
      "type": "object",
      "additionalProperties": true,
      "required": ["kind", "spec"],
      "properties": {
        "kind": {
          "type": "string",
          "enum": ["pypi", "oci", "git", "zip", "other"],
          "description": "Artifact type to install."
        },
        "spec": {
          "type": "object",
          "minProperties": 1,
          "additionalProperties": true,
          "description": "Artifact-specific spec. Common keys: package/version (pypi), image/tag/digest (oci), repo/ref (git), url/digest (zip)."
        },
        "sig_uri": { "type": "string", "format": "uri" },
        "sbom_uri": { "type": "string", "format": "uri" }
      }
    },
    "mcpServer": {
      "type": "object",
      "additionalProperties": true,
      "required": ["name", "transport", "url"],
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "transport": { "type": "string", "enum": ["WEBSOCKET", "HTTP", "STDIO", "SSE"] },
        "url": { "type": "string", "format": "uri" },
        "description": { "type": "string" },
        "annotations": { "type": "object", "additionalProperties": true }
      }
    }
  }
}
