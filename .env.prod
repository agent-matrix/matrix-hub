# ==============================================================================
# Matrix Hub — unified environment file
# Copy to ".env" and adjust as needed.
# Defaults target REMOTE Postgres; local dev options are included below (commented).
# ==============================================================================

# -------------------------
# Server
# -------------------------
APP_NAME=matrix-hub
HOST=0.0.0.0
PORT=443
LOG_LEVEL=INFO

# Optional admin API token for protected endpoints (leave blank to disable auth)
API_TOKEN=

# -------------------------
# Database (ACTIVE: REMOTE POSTGRES)
# -------------------------
# Use this when your DB is a remote server (your current setup).
POSTGRES_HOST=<REMOTE SERVER>
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres

# SQLAlchemy/psycopg DSN → Remote Postgres
DATABASE_URL=postgresql+psycopg://postgres:postgres@<REMOTE SERVER>:5432/postgres?connect_timeout=10

# Provide aliases some codepaths may use
SQLALCHEMY_DATABASE_URI=${DATABASE_URL}
DB_URL=${DATABASE_URL}

# We are NOT using SQLite here; migrations handle schema.
INIT_DB=false

# Gunicorn workers (tune up later)
WEB_CONCURRENCY=1


# ---------------------------------------------------------------------------
# (OPTION A: LOCAL DEV — SQLite quickstart)  ← uncomment this block and
# comment the REMOTE POSTGRES block above to use SQLite locally.
# ---------------------------------------------------------------------------
# DATABASE_URL=sqlite+pysqlite:///./data/catalog.sqlite
# SQLALCHEMY_DATABASE_URI=${DATABASE_URL}
# DB_URL=${DATABASE_URL}
# INIT_DB=true
# WEB_CONCURRENCY=1


# ---------------------------------------------------------------------------
# (OPTION B: LOCAL DEV — Postgres on your laptop)
# Make sure a local Postgres is running and a DB exists.
# ---------------------------------------------------------------------------
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_USER=matrix
# POSTGRES_PASSWORD=matrix
# POSTGRES_DB=matrixhub
# DATABASE_URL=postgresql+psycopg://matrix:matrix@localhost:5432/matrixhub
# SQLALCHEMY_DATABASE_URI=${DATABASE_URL}
# DB_URL=${DATABASE_URL}
# INIT_DB=false
# WEB_CONCURRENCY=1


# ---------------------------------------------------------------------------
# (OPTION C: DOCKER NETWORK — Postgres container on the same network)
# Use when Hub container and DB container share 'matrixhub-net' and the DB
# container name is 'matrixhub-db'.
# ---------------------------------------------------------------------------
# POSTGRES_HOST=matrixhub-db
# POSTGRES_PORT=5432
# POSTGRES_USER=postgres
# POSTGRES_PASSWORD=postgres
# POSTGRES_DB=postgres
# DATABASE_URL=postgresql+psycopg://postgres:postgres@matrixhub-db:5432/postgres
# SQLALCHEMY_DATABASE_URI=${DATABASE_URL}
# DB_URL=${DATABASE_URL}
# INIT_DB=false
# WEB_CONCURRENCY=1


# -------------------------
# Search & ranking
# Keep "none" unless these extensions are enabled in Postgres.
# Switch to pgtrgm/pgvector after enabling on your DB.
# -------------------------
SEARCH_LEXICAL_BACKEND=none          # options: pgtrgm | none
SEARCH_VECTOR_BACKEND=none           # options: pgvector | milvus | none
SEARCH_HYBRID_WEIGHTS=sem:0.6,lex:0.4,rec:0.1,q:0.1
RAG_ENABLED=false
EMBED_MODEL=sentence-transformers/all-MiniLM-L6-v2

# -------------------------
# Catalog ingestion
# -------------------------
CATALOG_REMOTES=["https://raw.githubusercontent.com/agent-matrix/catalog/main/index.json"]
INGEST_INTERVAL_MIN=15

# -------------------------
# MCP Gateway integration
# -------------------------
MCP_GATEWAY_URL=http://127.0.0.1:4444
MCP_GATEWAY_TOKEN=supersecret

# -------------------------
# Misc
# -------------------------
PIP_INDEX_URL=
HTTP_PROXY=
HTTPS_PROXY=
NO_PROXY=localhost,127.0.0.1

# -------------------------
# Legacy defaults used by some scripts (keep aligned with active DB)
# -------------------------
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres
